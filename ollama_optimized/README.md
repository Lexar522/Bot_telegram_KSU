# üöÄ –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π OLLAMA –∫–ª—ñ—î–Ω—Ç

## üìã –û–ø–∏—Å

–û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ OLLAMA API –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è–º–∏:

- ‚úÖ **–ö–µ—à—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π** - —à–≤–∏–¥—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è —Ç–∏–ø–æ–≤–∏—Ö –ø–∏—Ç–∞–Ω—å
- ‚úÖ **–°–µ–º–∞–Ω—Ç–∏—á–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è** - –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —Å—Ö–æ–∂—ñ –ø–∏—Ç–∞–Ω–Ω—è –∑–∞ –∑–º—ñ—Å—Ç–æ–º (+20-30% cache hit rate)
- ‚úÖ **Streaming API** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –±–∞—á–∞—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ —á–∞—Å—Ç–∏–Ω–∞—Ö (-40-60% —á–∞—Å—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è)
- ‚úÖ **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞** - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫—ñ–ª—å–∫–æ—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ç–∞ –≤–∏–±—ñ—Ä –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ (+20% —à–≤–∏–¥–∫–æ—Å—Ç—ñ)
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏** - —Ä—ñ–∑–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –ø–∏—Ç–∞–Ω—å
- ‚úÖ **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É** - –∑–≤—É–∂–µ–Ω–Ω—è –¥–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö —Å–µ–∫—Ü—ñ–π
- ‚úÖ **–ë–∞–≥–∞—Ç–æ—Ä—ñ–≤–Ω–µ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è** - –ø–æ–∫—Ä–∞—â–µ–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- ‚úÖ **–ú–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥** - –∑–±—ñ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–æ–±–æ—Ç–∏
- ‚úÖ **Chain-of-Thought** - –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å
- ‚úÖ **–ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É –ø–∏—Ç–∞–Ω–Ω—è

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
ollama_optimized/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ client.py              # –û—Å–Ω–æ–≤–Ω–∏–π –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç
‚îú‚îÄ‚îÄ prompt_builder.py      # –ü–æ–±—É–¥–æ–≤–∞ –ø—Ä–æ–º–ø—Ç—ñ–≤
‚îú‚îÄ‚îÄ context_optimizer.py    # –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
‚îú‚îÄ‚îÄ question_classifier.py # –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω—å
‚îú‚îÄ‚îÄ cache.py              # –ö–µ—à—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
‚îú‚îÄ‚îÄ validators/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ multi_level.py    # –ë–∞–≥–∞—Ç–æ—Ä—ñ–≤–Ω–µ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è
‚îî‚îÄ‚îÄ metrics/
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îî‚îÄ‚îÄ collector.py      # –ó–±—ñ—Ä –º–µ—Ç—Ä–∏–∫
```

## üíª –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```python
from ollama_optimized.client import OptimizedOllamaClient

client = OptimizedOllamaClient()

# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
response = await client.generate_response("–Ø–∫—ñ —î —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∏ –≤ –•–î–£?")
```

### –ó –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

```python
context = [
    {"user_message": "–ü—Ä–∏–≤—ñ—Ç", "bot_response": "–í—ñ—Ç–∞—é!"}
]

response = await client.generate_response(
    "–°–∫—ñ–ª—å–∫–∏ –∫–æ—à—Ç—É—î –Ω–∞–≤—á–∞–Ω–Ω—è?",
    context=context
)
```

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```python
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–æ–±–æ—Ç–∏
stats = client.get_statistics()
print(f"Cache hit rate: {stats['cache_hit_rate']:.2f}%")
print(f"Avg response time: {stats['avg_response_time']:.2f}s")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à—É
cache_stats = client.get_cache_stats()
print(f"Cache size: {cache_stats['size']}/{cache_stats['max_size']}")
```

## üéØ –¢–∏–ø–∏ –ø–∏—Ç–∞–Ω—å

–ö–ª—ñ—î–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–ª–∞—Å–∏—Ñ—ñ–∫—É—î –ø–∏—Ç–∞–Ω–Ω—è –Ω–∞ 6 —Ç–∏–ø—ñ–≤:

1. **factual** - —Ñ–∞–∫—Ç–∏—á–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è ("–Ø–∫—ñ —î —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∏?")
2. **comparison** - –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è ("–í —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è?")
3. **procedural** - –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ñ ("–Ø–∫ –ø–æ–¥–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏?")
4. **admission** - –ø—Ä–æ –≤—Å—Ç—É–ø ("–ü—Ä–∞–≤–∏–ª–∞ –≤—Å—Ç—É–ø—É")
5. **tuition** - –ø—Ä–æ –≤–∞—Ä—Ç—ñ—Å—Ç—å ("–°–∫—ñ–ª—å–∫–∏ –∫–æ—à—Ç—É—î?")
6. **faculties** - –ø—Ä–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∏ ("–Ø–∫—ñ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—Å—Ç—ñ?")

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó

–ö–æ–∂–µ–Ω —Ç–∏–ø –ø–∏—Ç–∞–Ω–Ω—è –º–∞—î —Å–≤–æ—ó –æ–ø—Ç–∏–º–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

```python
# –ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è factual –ø–∏—Ç–∞–Ω—å
params = {
    "temperature": 0.1,      # –ù–∏–∑—å–∫–∞ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç—ñ
    "top_p": 0.5,
    "num_predict": 200,      # –ö–æ—Ä–æ—Ç–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
    "repeat_penalty": 1.3,
    "top_k": 30
}
```

### –ö–µ—à—É–≤–∞–Ω–Ω—è

```python
# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–µ—à—É
cache = ResponseCache(
    max_size=200,      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤
    ttl_hours=24       # –ß–∞—Å –∂–∏—Ç—Ç—è –∑–∞–ø–∏—Å—É
)
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏

–ú–µ—Ç—Ä–∏–∫–∏ –∑–±–∏—Ä–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

- `total_requests` - –∑–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
- `cache_hits` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–ø–∞–¥–∞–Ω—å –≤ –∫–µ—à
- `validation_failures` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- `avg_response_time` - —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- `avg_response_length` - —Å–µ—Ä–µ–¥–Ω—è –¥–æ–≤–∂–∏–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- `question_types_distribution` - —Ä–æ–∑–ø–æ–¥—ñ–ª –ø–æ —Ç–∏–ø–∞—Ö –ø–∏—Ç–∞–Ω—å

## üîß –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ç–∏–ø—É –ø–∏—Ç–∞–Ω–Ω—è

```python
# –í question_classifier.py
QUESTION_PATTERNS = {
    "new_type": [
        r"–ø–∞—Ç–µ—Ä–Ω1", r"–ø–∞—Ç–µ—Ä–Ω2"
    ]
}

# –í client.py
generation_params = {
    "new_type": {
        "temperature": 0.15,
        "top_p": 0.6,
        # ...
    }
}
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è few-shot examples

```python
# –í prompt_builder.py
FEW_SHOT_EXAMPLES = {
    "new_type": """
    –ü–∏—Ç–∞–Ω–Ω—è: "–ü—Ä–∏–∫–ª–∞–¥ –ø–∏—Ç–∞–Ω–Ω—è"
    –í—ñ–¥–ø–æ–≤—ñ–¥—å: "–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ"
    """
}
```

## üêõ –í—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

### –õ–æ–≥—É–≤–∞–Ω–Ω—è

```python
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger('ollama_optimized')
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤'—è

```python
is_healthy = await client.check_health()
if not is_healthy:
    print("OLLAMA –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞!")
```

## üìà –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

### –û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- ‚ö° **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: -50-70% —á–∞—Å—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–∑–∞–≤–¥—è–∫–∏ –∫–µ—à—É, streaming, –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ–π –æ–±—Ä–æ–±—Ü—ñ)
- üéØ **–Ø–∫—ñ—Å—Ç—å**: +10-15% —Ç–æ—á–Ω–æ—Å—Ç—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π (–∑–∞–≤–¥—è–∫–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ–π –æ–±—Ä–æ–±—Ü—ñ —Ç–∞ —Å–µ–º–∞–Ω—Ç–∏—á–Ω–æ–º—É –∫–µ—à—É–≤–∞–Ω–Ω—é)
- üíæ **–¢–æ–∫–µ–Ω–∏**: -50% –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ (–∑–∞–≤–¥—è–∫–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∫–æ–Ω—Ç–µ–∫—Å—Ç—É)
- ‚úÖ **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: -70% –ø–æ–º–∏–ª–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
- üìà **Cache hit rate**: +20-30% (–∑–∞–≤–¥—è–∫–∏ —Å–µ–º–∞–Ω—Ç–∏—á–Ω–æ–º—É –∫–µ—à—É–≤–∞–Ω–Ω—é)
- üöÄ **UX**: -40-60% —á–∞—Å—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è (–∑–∞–≤–¥—è–∫–∏ streaming)

## üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è

–ü—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ —ñ—Å–Ω—É—é—á–∏–º –∫–æ–¥–æ–º
2. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
3. –ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ —è–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ß–∞—Å—Ç–∏–Ω–∞ –ø—Ä–æ—î–∫—Ç—É Telegram-–±–æ—Ç–∞ –•–î–£

