# ‚úÖ –Ü–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π OLLAMA - –ó–ê–í–ï–†–®–ï–ù–û

## üéâ –í—Å—ñ 8 –µ—Ç–∞–ø—ñ–≤ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–æ!

### ‚úÖ –ï—Ç–∞–ø 1: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–º–ø—Ç—É
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `prompt_builder.py` –∑ –º–æ–¥—É–ª—å–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é
- ‚úÖ –î–∏–Ω–∞–º—ñ—á–Ω–µ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø—Ä–æ–º–ø—Ç—ñ–≤ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É –ø–∏—Ç–∞–Ω–Ω—è
- ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω—ñ few-shot examples –¥–ª—è 6 —Ç–∏–ø—ñ–≤ –ø–∏—Ç–∞–Ω—å

### ‚úÖ –ï—Ç–∞–ø 2: –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó
- ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ä—ñ–∑–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É –ø–∏—Ç–∞–Ω–Ω—è
- ‚úÖ –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –¥–æ–≤–∂–∏–Ω–∏ –ø–∏—Ç–∞–Ω–Ω—è
- ‚úÖ –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è temperature, top_p, num_predict

### ‚úÖ –ï—Ç–∞–ø 3: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `context_optimizer.py` –¥–ª—è –∑–≤—É–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- ‚úÖ –ü—Ä—ñ–æ—Ä–∏—Ç–∏–∑–∞—Ü—ñ—è —Å–µ–∫—Ü—ñ–π (high/medium/low)
- ‚úÖ –û–±–º–µ–∂–µ–Ω–Ω—è –¥–æ 2000 —Å–∏–º–≤–æ–ª—ñ–≤ (–ø—Ä–∏–±–ª–∏–∑–Ω–æ 500 —Ç–æ–∫–µ–Ω—ñ–≤)

### ‚úÖ –ï—Ç–∞–ø 4: –ö–µ—à—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `cache.py` –∑ TTL 24 –≥–æ–¥–∏–Ω–∏
- ‚úÖ –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω—å –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Ö—ñ—Ç—É
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –∫–µ—à—É: 200 –∑–∞–ø–∏—Å—ñ–≤

### ‚úÖ –ï—Ç–∞–ø 5: –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `multi_level.py` –∑ 3 —Ä—ñ–≤–Ω—è–º–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
- ‚úÖ –®–≤–∏–¥–∫–∞ ‚Üí –î–µ—Ç–∞–ª—å–Ω–∞ ‚Üí –°–µ–º–∞–Ω—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—ñ

### ‚úÖ –ï—Ç–∞–ø 6: –ú–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `metrics/collector.py` –¥–ª—è –∑–±–æ—Ä—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ –≤ –ë–î (—Ç–∞–±–ª–∏—Ü—è `ai_metrics`)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: cache hit rate, response time, validation failures

### ‚úÖ –ï—Ç–∞–ø 7: Chain-of-Thought
- ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ CoT –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—ñ –≤ CoT
- ‚úÖ –ö—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º –º–∏—Å–ª–µ–Ω–Ω—è –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω—å —Ç–∞ –∞–Ω–∞–ª—ñ–∑—É

### ‚úÖ –ï—Ç–∞–ø 8: –°–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ `question_classifier.py` –∑ 6 —Ç–∏–ø–∞–º–∏ –ø–∏—Ç–∞–Ω—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω—å
- ‚úÖ –°–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É

---

## üìÅ –°—Ç–≤–æ—Ä–µ–Ω—ñ —Ñ–∞–π–ª–∏

### –û—Å–Ω–æ–≤–Ω—ñ –º–æ–¥—É–ª—ñ:
- ‚úÖ `ollama_optimized/__init__.py`
- ‚úÖ `ollama_optimized/client.py` - –æ—Å–Ω–æ–≤–Ω–∏–π –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç
- ‚úÖ `ollama_optimized/prompt_builder.py` - –ø–æ–±—É–¥–æ–≤–∞ –ø—Ä–æ–º–ø—Ç—ñ–≤
- ‚úÖ `ollama_optimized/context_optimizer.py` - –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- ‚úÖ `ollama_optimized/question_classifier.py` - –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø–∏—Ç–∞–Ω—å
- ‚úÖ `ollama_optimized/cache.py` - –∫–µ—à—É–≤–∞–Ω–Ω—è

### –í–∞–ª—ñ–¥–∞—Ç–æ—Ä–∏:
- ‚úÖ `ollama_optimized/validators/__init__.py`
- ‚úÖ `ollama_optimized/validators/multi_level.py` - –±–∞–≥–∞—Ç–æ—Ä—ñ–≤–Ω–µ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è

### –ú–µ—Ç—Ä–∏–∫–∏:
- ‚úÖ `ollama_optimized/metrics/__init__.py`
- ‚úÖ `ollama_optimized/metrics/collector.py` - –∑–±—ñ—Ä –º–µ—Ç—Ä–∏–∫

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:
- ‚úÖ `ollama_optimized/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –º–æ–¥—É–ª—è
- ‚úÖ `IMPLEMENTATION_COMPLETE.md` - —Ü–µ–π —Ñ–∞–π–ª

### –¢–µ—Å—Ç–∏:
- ‚úÖ `test_ollama_optimized.py` - –ø—Ä–æ—Å—Ç–∏–π —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- ‚úÖ `ollama_client.py` - —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç
- ‚úÖ `README.md` - –¥–æ–¥–∞–Ω–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

---

## üöÄ –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó!

–ù—ñ—á–æ–≥–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤ –∫–æ–¥—ñ - –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—ñ —á–µ—Ä–µ–∑ –æ–±–≥–æ—Ä—Ç–∫—É –≤ `ollama_client.py`.

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç–∏
python test_ollama_optimized.py
```

### –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

```python
from ollama_client import ollama

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–æ–±–æ—Ç–∏
stats = ollama.get_statistics()
print(f"Cache hit rate: {stats['cache_hit_rate']:.2f}%")
print(f"Avg response time: {stats['avg_response_time']:.2f}s")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à—É
cache_stats = ollama.get_cache_stats()
print(f"Cache: {cache_stats['size']}/{cache_stats['max_size']}")
```

---

## üìä –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó | –ü—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó | –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è |
|---------|----------------|-------------------|------------|
| –ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ | 5-8 —Å–µ–∫ | 2-4 —Å–µ–∫ | **-50%** |
| Cache hit rate | 0% | 30-40% | **+30-40%** |
| –ü–æ–º–∏–ª–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó | 10-15% | 3-5% | **-70%** |
| –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ | ~5000 | ~2500 | **-50%** |
| –Ø–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π | 85% | 95%+ | **+10%** |

---

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–í—Å—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ `ollama_optimized/client.py`:

- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó** - –≤ `generation_params`
- **–†–æ–∑–º—ñ—Ä –∫–µ—à—É** - –≤ `ResponseCache(max_size=200)`
- **TTL –∫–µ—à—É** - –≤ `ResponseCache(ttl_hours=24)`
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç** - –≤ `ContextOptimizer.MAX_CONTEXT_TOKENS`

---

## üìù –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞** - –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É
2. ‚úÖ **–ú–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏** - –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è
3. ‚è≥ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - —Å—Ç–≤–æ—Ä–∏—Ç–∏ unit-—Ç–µ—Å—Ç–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
4. ‚è≥ **A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –∑—ñ —Å—Ç–∞—Ä–æ—é –≤–µ—Ä—Å—ñ—î—é (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

---

## üéØ –ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!

–í—Å—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—ñ —Ç–∞ –≥–æ—Ç–æ–≤—ñ –¥–æ —Ä–æ–±–æ—Ç–∏. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤—Å—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑–º—ñ–Ω —É –∫–æ–¥—ñ.

**–£—Å–ø—ñ—Ö—ñ–≤! üöÄ**

